# kcp-netty

参考地址：https://github.com/szhnet/kcp-netty

可靠UDP实现

关于kcp的说明，https://www.oschina.net/p/kcp?hmsr=aladdin1e1

后续自己如果工作遇到了可以改造成starter，现阶段没有用到，我暂时做一个了解。

我可以说下如何用这个kcp来做游戏开发。

例如王者荣耀。
1.  匹配成功，在战斗服务（kcp实现）创建一个房间。
2.  推送战斗服务连接地址(ip和端口)给客户端。
3.  客户端推送消息（连接服务端，客户端打开udp的端口，传送自己的信息），服务端要进行校验，对比，如果成功无误，服务端缓存房间，uid，还有channel的映射关系。
4.  每次客户端推送消息上来都可以更新一下channel，客户端是udp没有连接，推送消息失败就失败了。
5.  服务端广播消息给客户端，通过roomId找到所有的channel，推送消息给客户端

kcp简介
KCP是一个快速可靠协议，能以比 TCP浪费10%-20%的带宽的代价，换取平均延迟降低 30%-40%，且最大延迟降低三倍的传输效果。纯算法实现，并不负责底层协议（如UDP）的收发，需要使用者自己定义下层数据包的发送方式，以 callback的方式提供给 KCP。 连时钟都需要外部传递进来，内部不会有任何一次系统调用。本文传输协议之考虑UDP的情况。

网上的意思是：kcp每个消息发送3个包，客户端收到最新的包就执行，重复的包丢弃即可，这样子的好处是，假如丢包率是25%,那么三个重复包丢失的概率是25%*3。
听起来挺有道理的。

具体的我还没有研究，我只是大致跑了一下，先有个概念，这里先备注一下，以后工作遇到类似的问题，回过头来研究。


